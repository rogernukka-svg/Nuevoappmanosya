(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8713],{8681:function(e,s,a){Promise.resolve().then(a.bind(a,3258))},3258:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return l}});var t=a(7437),n=a(2265),i=a(4667);function c(e){return(e/100).toFixed(2)}function l(){var e;let[s,a]=(0,n.useState)(null),[l,r]=(0,n.useState)(null),[d,o]=(0,n.useState)([]),[u,m]=(0,n.useState)(null),[x,h]=(0,n.useState)(!1);async function p(){let{data:{user:e}}=await i.supabase.auth.getUser();if(!e){window.location.href="/login";return}let{data:s}=await i.supabase.from("wallets").select("*").eq("user_id",e.id).maybeSingle(),{data:t}=await i.supabase.from("subscriptions").select("*").eq("user_id",e.id).maybeSingle(),{data:n}=await i.supabase.from("transactions").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}).limit(20);a(s),r(t),o(null!=n?n:[])}async function b(){h(!0),m(null);let e="sub_"+Date.now().toString(36),{error:s}=await i.supabase.rpc("pay_subscription",{plan_slug:"worker_basic",idempotency_key:e});h(!1),s?m(s.message):p()}return(0,n.useEffect)(()=>{p()},[]),(0,t.jsxs)("div",{className:"max-w-2xl mx-auto card",children:[(0,t.jsx)("h1",{children:"Billetera y suscripci\xf3n"}),(0,t.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"bg-black/20 rounded-xl p-3",children:[(0,t.jsx)("div",{className:"text-sm opacity-75",children:"Saldo"}),(0,t.jsxs)("div",{className:"text-3xl font-extrabold",children:["$",s?c(s.balance_cents):"0.00"]})]}),(0,t.jsxs)("div",{className:"bg-black/20 rounded-xl p-3",children:[(0,t.jsx)("div",{className:"text-sm opacity-75",children:"Suscripci\xf3n"}),(0,t.jsx)("div",{className:"font-bold",children:null!==(e=null==l?void 0:l.status)&&void 0!==e?e:"sin suscripci\xf3n"}),(null==l?void 0:l.current_period_end)&&(0,t.jsxs)("div",{className:"text-xs opacity-75",children:["Vence: ",new Date(l.current_period_end).toLocaleString()]})]})]}),(0,t.jsxs)("div",{className:"mt-3",children:[(0,t.jsx)("button",{className:"btn",onClick:b,disabled:x,children:x?"Procesando...":"Pagar $3.50 (Worker Basic)"}),u&&(0,t.jsx)("div",{className:"text-red-400 text-sm mt-2",children:u})]}),(0,t.jsxs)("div",{className:"mt-5",children:[(0,t.jsx)("h2",{children:"Movimientos"}),(0,t.jsxs)("div",{className:"mt-2 space-y-2",children:[d.map(e=>(0,t.jsxs)("div",{className:"bg-black/20 rounded-xl p-3 flex justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-bold",children:e.type}),(0,t.jsx)("div",{className:"text-xs opacity-75",children:new Date(e.created_at).toLocaleString()}),e.note&&(0,t.jsx)("div",{className:"text-xs opacity-75",children:e.note})]}),(0,t.jsxs)("div",{className:"font-bold ".concat(e.amount_cents>=0?"text-green-300":"text-red-300"),children:[e.amount_cents>=0?"+":"-","$",c(Math.abs(e.amount_cents))]})]},e.id)),0===d.length&&(0,t.jsx)("div",{className:"text-sm opacity-75",children:"Sin movimientos."})]})]})]})}},4667:function(e,s,a){"use strict";a.d(s,{S:function(){return i}});var t=a(951);let n=null;function i(){if(n)return n;let e="https://ydtficoxjuxsoaxtghhj.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkdGZpY294anV4c29heHRnaGhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAwOTUwNDIsImV4cCI6MjA3NTY3MTA0Mn0.KBRDCAJYvjpmcXRnYFcuSI8Mn0zYfJzaN0QJo63gzy8";if(!e||!s)throw console.error("❌ Faltan variables de entorno de Supabase."),Error("Variables de entorno Supabase no configuradas.");return n=(0,t.createBrowserClient)(e,s,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}}),console.log("✅ Supabase (browser client) inicializado en",e),n}}},function(e){e.O(0,[951,2971,7023,1744],function(){return e(e.s=8681)}),_N_E=e.O()}]);