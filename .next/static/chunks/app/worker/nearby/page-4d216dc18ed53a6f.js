(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1418],{6738:function(e,a,s){Promise.resolve().then(s.bind(s,3842))},3842:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return r}});var t=s(7437),n=s(2265),i=s(4667);let l=[{slug:"limpieza",name:"Limpieza"},{slug:"plomeria",name:"Plomer\xeda"},{slug:"jardineria",name:"Jardiner\xeda / C\xe9sped"},{slug:"electricidad",name:"Electricidad"},{slug:"auxilio-vehicular",name:"Auxilio vehicular"},{slug:"fletes",name:"Fletes"}],c=[3,5,10,15,20];function r(){let[e,a]=(0,n.useState)(null),[s,r]=(0,n.useState)(l[0].slug),[o,u]=(0,n.useState)(5),[d,m]=(0,n.useState)(!1),[h,b]=(0,n.useState)([]),[p,x]=(0,n.useState)(null),[j,g]=(0,n.useState)(null);async function f(){if(!navigator.geolocation){g("Tu navegador no soporta geolocalizaci\xf3n");return}navigator.geolocation.getCurrentPosition(async e=>{let s={lon:e.coords.longitude,lat:e.coords.latitude};a(s),await i.supabase.rpc("set_my_worker_location",s)},e=>g(e.message),{enableHighAccuracy:!0})}async function N(){if(!e)return g("Primero actualiz\xe1 tu ubicaci\xf3n");m(!0),g(null);let{data:a,error:t}=await i.supabase.rpc("fn_find_nearby_jobs",{lon:e.lon,lat:e.lat,skill_slug:s,max_km:o});m(!1),t?g(t.message):(b(a||[]),x("".concat((a||[]).length," trabajo(s) encontrados")))}async function v(e){let{error:a}=await i.supabase.rpc("take_job",{job_id:e});if(a)return alert(a.message);alert('✅ Tomaste el trabajo. Revis\xe1 en "Mis trabajos".'),N()}return(0,t.jsxs)("div",{className:"container",children:[(0,t.jsx)("header",{className:"mt-6 mb-4 flex items-end justify-between",children:(0,t.jsx)("h1",{className:"text-2xl font-extrabold",children:"Trabajos cerca"})}),(0,t.jsxs)("section",{className:"card p-4 mb-6",children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-4 gap-4",children:[(0,t.jsx)("select",{value:s,onChange:e=>r(e.target.value),className:"select",children:l.map(e=>(0,t.jsx)("option",{value:e.slug,children:e.name},e.slug))}),(0,t.jsx)("select",{value:o,onChange:e=>u(Number(e.target.value)),className:"select",children:c.map(e=>(0,t.jsxs)("option",{value:e,children:[e," km"]},e))}),(0,t.jsx)("button",{onClick:f,className:"btn btn-ghost",children:"Actualizar ubicaci\xf3n"}),(0,t.jsx)("button",{onClick:N,disabled:d,className:"btn btn-primary",children:d?"Buscando…":"Buscar trabajos"})]}),e&&(0,t.jsxs)("div",{className:"text-xs text-white/60 mt-2",children:["Ubicaci\xf3n: ",e.lat.toFixed(4),", ",e.lon.toFixed(4)]})]}),j&&(0,t.jsx)("div",{className:"text-red-400",children:j}),p&&(0,t.jsx)("div",{className:"text-white/60",children:p}),(0,t.jsx)("div",{className:"space-y-3",children:h.map(e=>(0,t.jsxs)("article",{className:"card p-4 flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-bold",children:e.title}),(0,t.jsx)("p",{className:"text-sm opacity-70",children:e.description})]}),(0,t.jsx)("button",{onClick:()=>v(e.id),className:"btn btn-primary",children:"Tomar"})]},e.id))})]})}},4667:function(e,a,s){"use strict";s.d(a,{S:function(){return i}});var t=s(951);let n=null;function i(){if(n)return n;let e="https://ydtficoxjuxsoaxtghhj.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkdGZpY294anV4c29heHRnaGhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAwOTUwNDIsImV4cCI6MjA3NTY3MTA0Mn0.KBRDCAJYvjpmcXRnYFcuSI8Mn0zYfJzaN0QJo63gzy8";if(!e||!a)throw console.error("❌ Faltan variables de entorno de Supabase."),Error("Variables de entorno Supabase no configuradas.");return n=(0,t.createBrowserClient)(e,a,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}}),console.log("✅ Supabase (browser client) inicializado en",e),n}}},function(e){e.O(0,[951,2971,7023,1744],function(){return e(e.s=6738)}),_N_E=e.O()}]);