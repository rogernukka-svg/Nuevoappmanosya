(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9596],{111:function(e,a,r){Promise.resolve().then(r.bind(r,4))},4:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return x}});var t=r(7437),s=r(2265),l=r(3763),i=r(7776),n=r(4667),o=r(8030);let d=(0,o.Z)("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]),c=(0,o.Z)("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]]);var u=r(4232),m=r(3193);let h=(0,n.S)(),p=[{slug:"limpieza",name:"Limpieza y mantenimiento"},{slug:"plomeria",name:"Plomer\xeda"},{slug:"jardineria",name:"Jardiner\xeda y c\xe9sped"},{slug:"electricidad",name:"Electricidad y cableado"},{slug:"auxilio",name:"Auxilio vehicular"}];function x(){return(0,t.jsx)(l.E.div,{className:"min-h-screen bg-gradient-to-b from-white via-gray-50 to-gray-100 text-gray-900 pb-32",initial:{opacity:0},animate:{opacity:1},children:(0,t.jsxs)("div",{className:"max-w-5xl mx-auto px-6 pt-10",children:[(0,t.jsxs)("h1",{className:"text-3xl font-extrabold text-emerald-600 mb-2 flex items-center gap-2",children:[(0,t.jsx)(d,{className:"w-7 h-7"}),"Publicar servicio / pedido empresarial"]}),(0,t.jsx)("p",{className:"text-gray-600 mb-8",children:"Defin\xed el alcance, la planificaci\xf3n y dej\xe1 que ManosYA asigne autom\xe1ticamente personal cercano y disponible."}),(0,t.jsxs)("div",{className:"grid lg:grid-cols-2 gap-8",children:[(0,t.jsx)(b,{}),(0,t.jsx)(g,{})]}),(0,t.jsxs)("div",{className:"mt-16 border-t border-gray-200 pt-8 text-center",children:[(0,t.jsxs)("h2",{className:"text-lg font-bold text-gray-800 flex items-center justify-center gap-2",children:[(0,t.jsx)(c,{className:"w-5 h-5 text-emerald-600"}),"\xbfTen\xe9s una empresa o comercio?"]}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Acced\xe9 al panel empresarial para gestionar servicios, personal asignado y planificaci\xf3n avanzada."}),(0,t.jsxs)("a",{href:"/business/jobs",className:"inline-flex items-center gap-2 mt-4 px-5 py-3 rounded-xl bg-emerald-500 hover:bg-emerald-600 text-white font-semibold transition shadow-md",children:[(0,t.jsx)(d,{className:"w-5 h-5"}),"Ir al Panel Empresarial"]})]})]})})}function b(){let[e,a]=(0,s.useState)(""),[r,n]=(0,s.useState)(""),[o,d]=(0,s.useState)(p[0].slug),[c,x]=(0,s.useState)(""),[b,g]=(0,s.useState)(25e3),[f,y]=(0,s.useState)(!0),[j,v]=(0,s.useState)("daily"),[N,w]=(0,s.useState)(""),[k,M]=(0,s.useState)(30),[S,_]=(0,s.useState)("08:00"),[C,D]=(0,s.useState)("12:00"),[I,E]=(0,s.useState)(null),[z,P]=(0,s.useState)(!1),[Z,A]=(0,s.useState)(null),[J,q]=(0,s.useState)(null),[T,V]=(0,s.useState)(null),[Y,F]=(0,s.useState)(""),[O,R]=(0,s.useState)(""),[U,G]=(0,s.useState)(""),[L,B]=(0,s.useState)(""),[H,X]=(0,s.useState)(""),[Q,K]=(0,s.useState)("");(0,s.useEffect)(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>E({lon:e.coords.longitude,lat:e.coords.latitude}),()=>{},{enableHighAccuracy:!0})},[]);let W=(0,s.useMemo)(()=>{if(!N||!k)return"";let e=new Date(N);return e.setDate(e.getDate()+Math.max(1,Number(k))-1),e.toISOString().slice(0,10)},[N,k]),$=(0,s.useMemo)(()=>{let e=Math.max(1,Number(k));return"once"===j?1:"daily"===j?e:"weekly"===j?Math.max(1,Math.ceil(e/7)):"weekdays"===j?Math.max(1,Math.round(5*e/7)):e},[k,j]),ee=(0,s.useMemo)(()=>N?{frequency:j,start_date:N,end_date:W||N,start_time:S,end_time:C,duration_days:Number(k),estimated_sessions:$}:null,[j,N,W,S,C,k,$]);async function ea(t){if(t.preventDefault(),P(!0),q(null),A(null),!I){q("Us\xe1 tu ubicaci\xf3n antes de publicar."),P(!1);return}if(!N){q("Seleccion\xe1 una fecha de inicio."),P(!1);return}try{let t=(await h.auth.getUser()).data.user,{data:s,error:l}=await h.from("profiles").select("id").eq("id",t.id).single();if(l||!s){console.error("❌ Perfil no encontrado:",l),i.A.error("No se encontr\xf3 tu perfil. Inici\xe1 sesi\xf3n nuevamente."),P(!1);return}let{data:d,error:u}=await h.from("jobs").insert({client_id:s.id,title:e,description:r,skill_slug:o,lon:I.lon,lat:I.lat,price_offer:Number(b),address_text:c,schedule:ee,auto_assign:f,status:"pending"}).select().single();if(u)throw u;V(d.id);let{error:m}=await h.from("business_jobs").insert({job_id:d.id,business_id:s.id,company_name:Y,contact_name:O,contact_phone:U,billing_email:L,billing_ruc:H,notes:Q});m&&console.error("⚠️ Error creando business_job:",m),f&&await h.rpc("assign_worker_auto",{p_job_id:d.id}).catch(()=>{}),i.A.success("✅ Pedido empresarial creado correctamente"),A("Trabajo publicado con \xe9xito."),P(!1),a(""),n(""),x(""),F(""),R(""),G(""),B(""),X(""),K("")}catch(e){console.error("❌ Error al crear trabajo:",e),i.A.error("No se pudo publicar el trabajo"),q(e.message),P(!1)}}return(0,t.jsxs)(l.E.form,{onSubmit:ea,className:"bg-white rounded-3xl shadow-md p-6 md:p-8 space-y-6 border border-gray-100",initial:{y:20,opacity:0},animate:{y:0,opacity:1},children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-5",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"font-semibold text-gray-700",children:"T\xedtulo del pedido"}),(0,t.jsx)("input",{className:"w-full mt-1 rounded-xl border border-gray-200 p-3 focus:ring-2 focus:ring-emerald-400 outline-none",placeholder:"Ej: Limpieza de oficina, mantenimiento el\xe9ctrico, etc.",value:e,onChange:e=>a(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"font-semibold text-gray-700",children:"Descripci\xf3n"}),(0,t.jsx)("textarea",{className:"w-full mt-1 rounded-xl border border-gray-200 p-3 focus:ring-2 focus:ring-emerald-400 outline-none min-h-[100px]",placeholder:"Explic\xe1 brevemente tareas, horarios, condiciones, materiales, etc.",value:r,onChange:e=>n(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"font-semibold text-gray-700",children:"\xc1rea de servicio"}),(0,t.jsx)("select",{className:"w-full mt-1 rounded-xl border border-gray-200 p-3 bg-white focus:ring-2 focus:ring-emerald-400 outline-none",value:o,onChange:e=>d(e.target.value),children:p.map(e=>(0,t.jsx)("option",{value:e.slug,children:e.name},e.slug))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"font-semibold text-gray-700",children:"Precio sugerido (Gs.)"}),(0,t.jsx)("input",{type:"number",min:1e4,step:1e3,className:"w-full mt-1 rounded-xl border border-gray-200 p-3 focus:ring-2 focus:ring-emerald-400 outline-none",value:b,onChange:e=>g(e.target.value)})]})]}),(0,t.jsxs)("div",{className:"pt-4 border-t border-gray-200",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold text-emerald-600 mb-3 flex items-center gap-2",children:[(0,t.jsx)(u.Z,{className:"w-5 h-5"})," Datos de empresa / facturaci\xf3n"]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"font-semibold text-gray-700",children:"Nombre de la empresa"}),(0,t.jsx)("input",{className:"w-full mt-1 rounded-xl border border-gray-200 p-3 focus:ring-2 focus:ring-emerald-400 outline-none",placeholder:"Ej: LimpiaMax S.A.",value:Y,onChange:e=>F(e.target.value),required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"font-semibold text-gray-700",children:"Responsable / contacto"}),(0,t.jsx)("input",{className:"w-full mt-1 rounded-xl border border-gray-200 p-3",placeholder:"Nombre completo",value:O,onChange:e=>R(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"font-semibold text-gray-700",children:"Tel\xe9fono"}),(0,t.jsx)("input",{className:"w-full mt-1 rounded-xl border border-gray-200 p-3",placeholder:"0991 123 456",value:U,onChange:e=>G(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"font-semibold text-gray-700",children:"Email de facturaci\xf3n"}),(0,t.jsx)("input",{type:"email",className:"w-full mt-1 rounded-xl border border-gray-200 p-3",placeholder:"facturacion@empresa.com",value:L,onChange:e=>B(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"font-semibold text-gray-700",children:"RUC"}),(0,t.jsx)("input",{className:"w-full mt-1 rounded-xl border border-gray-200 p-3",placeholder:"Ej: 80012345-6",value:H,onChange:e=>X(e.target.value)})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"font-semibold text-gray-700",children:"Notas / comentarios"}),(0,t.jsx)("textarea",{className:"w-full mt-1 rounded-xl border border-gray-200 p-3 min-h-[80px]",placeholder:"Indicaciones adicionales, materiales incluidos, etc.",value:Q,onChange:e=>K(e.target.value)})]})]})]}),N&&(0,t.jsxs)("div",{className:"mt-6 bg-emerald-50 border border-emerald-100 rounded-2xl p-4 text-sm text-emerald-800",children:[(0,t.jsxs)("p",{className:"font-semibold mb-1 flex items-center gap-2",children:[(0,t.jsx)(m.Z,{className:"w-4 h-4"})," Planificaci\xf3n:"]}),(0,t.jsxs)("p",{children:["\uD83D\uDCC5 Del ",(0,t.jsx)("b",{children:N})," al ",(0,t.jsx)("b",{children:W})," (",$," d\xedas)"]}),(0,t.jsxs)("p",{children:["⏰ De ",(0,t.jsx)("b",{children:S})," a ",(0,t.jsx)("b",{children:C})," — Frecuencia: ",(0,t.jsx)("b",{children:j})]}),(0,t.jsxs)("p",{className:"mt-1",children:["\uD83D\uDCB0 Precio sugerido: ",(0,t.jsxs)("b",{children:[b.toLocaleString()," Gs."]})]}),I&&(0,t.jsxs)("p",{className:"mt-1",children:["\uD83D\uDCCD Ubicaci\xf3n detectada: lat ",I.lat.toFixed(4),", lon ",I.lon.toFixed(4)]})]}),(0,t.jsx)("button",{type:"submit",disabled:z,className:"w-full py-3 rounded-xl font-semibold text-white transition ".concat(z?"bg-gray-400 cursor-not-allowed":"bg-emerald-500 hover:bg-emerald-600 shadow-md"),children:z?"Publicando...":"Publicar pedido empresarial"})]})}function g(){return(0,t.jsx)("div",{className:"bg-white rounded-3xl shadow-md p-6 border border-gray-100 text-center text-gray-600",children:(0,t.jsx)("p",{className:"text-sm",children:"\uD83E\uDDE9 Vista previa en construcci\xf3n. Pr\xf3ximamente mostrar\xe1 el resumen del pedido empresarial antes de publicar."})})}},4667:function(e,a,r){"use strict";r.d(a,{S:function(){return l}});var t=r(951);let s=null;function l(){if(s)return s;let e="https://ydtficoxjuxsoaxtghhj.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkdGZpY294anV4c29heHRnaGhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAwOTUwNDIsImV4cCI6MjA3NTY3MTA0Mn0.KBRDCAJYvjpmcXRnYFcuSI8Mn0zYfJzaN0QJo63gzy8";if(!e||!a)throw console.error("❌ Faltan variables de entorno de Supabase."),Error("Variables de entorno Supabase no configuradas.");return s=(0,t.createBrowserClient)(e,a,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}}),console.log("✅ Supabase (browser client) inicializado en",e),s}},4232:function(e,a,r){"use strict";r.d(a,{Z:function(){return t}});let t=(0,r(8030).Z)("building-2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},3193:function(e,a,r){"use strict";r.d(a,{Z:function(){return t}});let t=(0,r(8030).Z)("calendar-clock",[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]])}},function(e){e.O(0,[951,7776,3642,2971,7023,1744],function(){return e(e.s=111)}),_N_E=e.O()}]);