(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4453],{7090:function(e,r,n){Promise.resolve().then(n.bind(n,3065))},3065:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return i}});var a=n(7437),s=n(2265),o=n(6463),t=n(4667);function i(){let e=(0,o.useRouter)();return(0,s.useEffect)(()=>{(async()=>{try{await t.supabase.auth.refreshSession();let{data:r,error:n}=await t.supabase.auth.getSession();if(n)throw n;let a=null==r?void 0:r.session;if(!a){console.warn("⚠️ No hay sesi\xf3n activa, redirigiendo al login"),e.replace("/login");return}let s=a.user;console.log("✅ Usuario autenticado:",s.email);let{data:o,error:i}=await t.supabase.from("profiles").select("role").eq("id",s.id).maybeSingle();if(i)throw i;if((null==o?void 0:o.role)==="worker")try{let{error:e}=await t.supabase.rpc("ensure_worker_profile");e&&console.warn("No se pudo crear/verificar worker_profile:",e.message)}catch(e){console.error("Error ejecutando ensure_worker_profile:",e.message)}switch(null==o?void 0:o.role){case"worker":e.replace("/worker/dashboard");break;case"client":e.replace("/client/dashboard");break;default:e.replace("/")}}catch(r){console.error("❌ Error en AuthCallback:",r.message),e.replace("/login")}})()},[e]),(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-black text-white",children:"Procesando inicio de sesi\xf3n…"})}},4667:function(e,r,n){"use strict";n.d(r,{S:function(){return o}});var a=n(951);let s=null;function o(){if(s)return s;let e="https://ydtficoxjuxsoaxtghhj.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkdGZpY294anV4c29heHRnaGhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAwOTUwNDIsImV4cCI6MjA3NTY3MTA0Mn0.KBRDCAJYvjpmcXRnYFcuSI8Mn0zYfJzaN0QJo63gzy8";if(!e||!r)throw console.error("❌ Faltan variables de entorno de Supabase."),Error("Variables de entorno Supabase no configuradas.");return s=(0,a.createBrowserClient)(e,r,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}}),console.log("✅ Supabase (browser client) inicializado en",e),s}},6463:function(e,r,n){"use strict";var a=n(1169);n.o(a,"useParams")&&n.d(r,{useParams:function(){return a.useParams}}),n.o(a,"usePathname")&&n.d(r,{usePathname:function(){return a.usePathname}}),n.o(a,"useRouter")&&n.d(r,{useRouter:function(){return a.useRouter}})}},function(e){e.O(0,[951,2971,7023,1744],function(){return e(e.s=7090)}),_N_E=e.O()}]);