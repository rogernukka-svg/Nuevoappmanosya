(()=>{var e={};e.id=596,e.ids=[596],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},2e3:(e,a,r)=>{"use strict";r.r(a),r.d(a,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d}),r(8410),r(9884),r(2309),r(5866);var t=r(3191),s=r(8716),l=r(7922),i=r.n(l),n=r(5231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);r.d(a,o);let d=["",{children:["client",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,8410)),"D:\\CARPETA ROGER\\CONESTESOYBILLONARIOYALOSOY\\jobs-mvp-next-pro-main\\app\\client\\new\\page.jsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,9884)),"D:\\CARPETA ROGER\\CONESTESOYBILLONARIOYALOSOY\\jobs-mvp-next-pro-main\\app\\client\\layout.jsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,2309)),"D:\\CARPETA ROGER\\CONESTESOYBILLONARIOYALOSOY\\jobs-mvp-next-pro-main\\app\\layout.jsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["D:\\CARPETA ROGER\\CONESTESOYBILLONARIOYALOSOY\\jobs-mvp-next-pro-main\\app\\client\\new\\page.jsx"],u="/client/new/page",m={require:r,loadChunk:()=>Promise.resolve()},p=new t.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/client/new/page",pathname:"/client/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},1235:(e,a,r)=>{Promise.resolve().then(r.bind(r,5794))},5794:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>h});var t=r(326),s=r(7577),l=r(5795),i=r(5999),n=r(3170),o=r(2881);let d=(0,o.Z)("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]),c=(0,o.Z)("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]]);var u=r(9734),m=r(1856);let p=(0,n.S)(),x=[{slug:"limpieza",name:"Limpieza y mantenimiento"},{slug:"plomeria",name:"Plomer\xeda"},{slug:"jardineria",name:"Jardiner\xeda y c\xe9sped"},{slug:"electricidad",name:"Electricidad y cableado"},{slug:"auxilio",name:"Auxilio vehicular"}];function h(){return t.jsx(l.E.div,{className:"min-h-screen bg-gradient-to-b from-white via-gray-50 to-gray-100 text-gray-900 pb-32",initial:{opacity:0},animate:{opacity:1},children:(0,t.jsxs)("div",{className:"max-w-5xl mx-auto px-6 pt-10",children:[(0,t.jsxs)("h1",{className:"text-3xl font-extrabold text-emerald-600 mb-2 flex items-center gap-2",children:[t.jsx(d,{className:"w-7 h-7"}),"Publicar servicio / pedido empresarial"]}),t.jsx("p",{className:"text-gray-600 mb-8",children:"Defin\xed el alcance, la planificaci\xf3n y dej\xe1 que ManosYA asigne autom\xe1ticamente personal cercano y disponible."}),(0,t.jsxs)("div",{className:"grid lg:grid-cols-2 gap-8",children:[t.jsx(g,{}),t.jsx(b,{})]}),(0,t.jsxs)("div",{className:"mt-16 border-t border-gray-200 pt-8 text-center",children:[(0,t.jsxs)("h2",{className:"text-lg font-bold text-gray-800 flex items-center justify-center gap-2",children:[t.jsx(c,{className:"w-5 h-5 text-emerald-600"}),"\xbfTen\xe9s una empresa o comercio?"]}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Acced\xe9 al panel empresarial para gestionar servicios, personal asignado y planificaci\xf3n avanzada."}),(0,t.jsxs)("a",{href:"/business/jobs",className:"inline-flex items-center gap-2 mt-4 px-5 py-3 rounded-xl bg-emerald-500 hover:bg-emerald-600 text-white font-semibold transition shadow-md",children:[t.jsx(d,{className:"w-5 h-5"}),"Ir al Panel Empresarial"]})]})]})})}function g(){let[e,a]=(0,s.useState)(""),[r,n]=(0,s.useState)(""),[o,d]=(0,s.useState)(x[0].slug),[c,h]=(0,s.useState)(""),[g,b]=(0,s.useState)(25e3),[j,f]=(0,s.useState)(!0),[y,v]=(0,s.useState)("daily"),[N,w]=(0,s.useState)(""),[S,O]=(0,s.useState)(30),[E,_]=(0,s.useState)("08:00"),[A,P]=(0,s.useState)("12:00"),[C,D]=(0,s.useState)(null),[R,M]=(0,s.useState)(!1),[L,k]=(0,s.useState)(null),[q,Y]=(0,s.useState)(null),[T,I]=(0,s.useState)(null),[G,z]=(0,s.useState)(""),[B,U]=(0,s.useState)(""),[Z,F]=(0,s.useState)(""),[$,V]=(0,s.useState)(""),[J,X]=(0,s.useState)(""),[H,K]=(0,s.useState)(""),Q=(0,s.useMemo)(()=>{if(!N||!S)return"";let e=new Date(N);return e.setDate(e.getDate()+Math.max(1,Number(S))-1),e.toISOString().slice(0,10)},[N,S]),W=(0,s.useMemo)(()=>{let e=Math.max(1,Number(S));return"once"===y?1:"daily"===y?e:"weekly"===y?Math.max(1,Math.ceil(e/7)):"weekdays"===y?Math.max(1,Math.round(5*e/7)):e},[S,y]),ee=(0,s.useMemo)(()=>N?{frequency:y,start_date:N,end_date:Q||N,start_time:E,end_time:A,duration_days:Number(S),estimated_sessions:W}:null,[y,N,Q,E,A,S,W]);async function ea(t){if(t.preventDefault(),M(!0),Y(null),k(null),!C){Y("Us\xe1 tu ubicaci\xf3n antes de publicar."),M(!1);return}if(!N){Y("Seleccion\xe1 una fecha de inicio."),M(!1);return}try{let t=(await p.auth.getUser()).data.user,{data:s,error:l}=await p.from("profiles").select("id").eq("id",t.id).single();if(l||!s){console.error("❌ Perfil no encontrado:",l),i.A.error("No se encontr\xf3 tu perfil. Inici\xe1 sesi\xf3n nuevamente."),M(!1);return}let{data:d,error:u}=await p.from("jobs").insert({client_id:s.id,title:e,description:r,skill_slug:o,lon:C.lon,lat:C.lat,price_offer:Number(g),address_text:c,schedule:ee,auto_assign:j,status:"pending"}).select().single();if(u)throw u;I(d.id);let{error:m}=await p.from("business_jobs").insert({job_id:d.id,business_id:s.id,company_name:G,contact_name:B,contact_phone:Z,billing_email:$,billing_ruc:J,notes:H});m&&console.error("⚠️ Error creando business_job:",m),j&&await p.rpc("assign_worker_auto",{p_job_id:d.id}).catch(()=>{}),i.A.success("✅ Pedido empresarial creado correctamente"),k("Trabajo publicado con \xe9xito."),M(!1),a(""),n(""),h(""),z(""),U(""),F(""),V(""),X(""),K("")}catch(e){console.error("❌ Error al crear trabajo:",e),i.A.error("No se pudo publicar el trabajo"),Y(e.message),M(!1)}}return(0,t.jsxs)(l.E.form,{onSubmit:ea,className:"bg-white rounded-3xl shadow-md p-6 md:p-8 space-y-6 border border-gray-100",initial:{y:20,opacity:0},animate:{y:0,opacity:1},children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-5",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"font-semibold text-gray-700",children:"T\xedtulo del pedido"}),t.jsx("input",{className:"w-full mt-1 rounded-xl border border-gray-200 p-3 focus:ring-2 focus:ring-emerald-400 outline-none",placeholder:"Ej: Limpieza de oficina, mantenimiento el\xe9ctrico, etc.",value:e,onChange:e=>a(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"font-semibold text-gray-700",children:"Descripci\xf3n"}),t.jsx("textarea",{className:"w-full mt-1 rounded-xl border border-gray-200 p-3 focus:ring-2 focus:ring-emerald-400 outline-none min-h-[100px]",placeholder:"Explic\xe1 brevemente tareas, horarios, condiciones, materiales, etc.",value:r,onChange:e=>n(e.target.value)})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"font-semibold text-gray-700",children:"\xc1rea de servicio"}),t.jsx("select",{className:"w-full mt-1 rounded-xl border border-gray-200 p-3 bg-white focus:ring-2 focus:ring-emerald-400 outline-none",value:o,onChange:e=>d(e.target.value),children:x.map(e=>t.jsx("option",{value:e.slug,children:e.name},e.slug))})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"font-semibold text-gray-700",children:"Precio sugerido (Gs.)"}),t.jsx("input",{type:"number",min:1e4,step:1e3,className:"w-full mt-1 rounded-xl border border-gray-200 p-3 focus:ring-2 focus:ring-emerald-400 outline-none",value:g,onChange:e=>b(e.target.value)})]})]}),(0,t.jsxs)("div",{className:"pt-4 border-t border-gray-200",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold text-emerald-600 mb-3 flex items-center gap-2",children:[t.jsx(u.Z,{className:"w-5 h-5"})," Datos de empresa / facturaci\xf3n"]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"font-semibold text-gray-700",children:"Nombre de la empresa"}),t.jsx("input",{className:"w-full mt-1 rounded-xl border border-gray-200 p-3 focus:ring-2 focus:ring-emerald-400 outline-none",placeholder:"Ej: LimpiaMax S.A.",value:G,onChange:e=>z(e.target.value),required:!0})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"font-semibold text-gray-700",children:"Responsable / contacto"}),t.jsx("input",{className:"w-full mt-1 rounded-xl border border-gray-200 p-3",placeholder:"Nombre completo",value:B,onChange:e=>U(e.target.value)})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"font-semibold text-gray-700",children:"Tel\xe9fono"}),t.jsx("input",{className:"w-full mt-1 rounded-xl border border-gray-200 p-3",placeholder:"0991 123 456",value:Z,onChange:e=>F(e.target.value)})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"font-semibold text-gray-700",children:"Email de facturaci\xf3n"}),t.jsx("input",{type:"email",className:"w-full mt-1 rounded-xl border border-gray-200 p-3",placeholder:"facturacion@empresa.com",value:$,onChange:e=>V(e.target.value)})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"font-semibold text-gray-700",children:"RUC"}),t.jsx("input",{className:"w-full mt-1 rounded-xl border border-gray-200 p-3",placeholder:"Ej: 80012345-6",value:J,onChange:e=>X(e.target.value)})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"font-semibold text-gray-700",children:"Notas / comentarios"}),t.jsx("textarea",{className:"w-full mt-1 rounded-xl border border-gray-200 p-3 min-h-[80px]",placeholder:"Indicaciones adicionales, materiales incluidos, etc.",value:H,onChange:e=>K(e.target.value)})]})]})]}),N&&(0,t.jsxs)("div",{className:"mt-6 bg-emerald-50 border border-emerald-100 rounded-2xl p-4 text-sm text-emerald-800",children:[(0,t.jsxs)("p",{className:"font-semibold mb-1 flex items-center gap-2",children:[t.jsx(m.Z,{className:"w-4 h-4"})," Planificaci\xf3n:"]}),(0,t.jsxs)("p",{children:["\uD83D\uDCC5 Del ",t.jsx("b",{children:N})," al ",t.jsx("b",{children:Q})," (",W," d\xedas)"]}),(0,t.jsxs)("p",{children:["⏰ De ",t.jsx("b",{children:E})," a ",t.jsx("b",{children:A})," — Frecuencia: ",t.jsx("b",{children:y})]}),(0,t.jsxs)("p",{className:"mt-1",children:["\uD83D\uDCB0 Precio sugerido: ",(0,t.jsxs)("b",{children:[g.toLocaleString()," Gs."]})]}),C&&(0,t.jsxs)("p",{className:"mt-1",children:["\uD83D\uDCCD Ubicaci\xf3n detectada: lat ",C.lat.toFixed(4),", lon ",C.lon.toFixed(4)]})]}),t.jsx("button",{type:"submit",disabled:R,className:`w-full py-3 rounded-xl font-semibold text-white transition ${R?"bg-gray-400 cursor-not-allowed":"bg-emerald-500 hover:bg-emerald-600 shadow-md"}`,children:R?"Publicando...":"Publicar pedido empresarial"})]})}function b(){return t.jsx("div",{className:"bg-white rounded-3xl shadow-md p-6 border border-gray-100 text-center text-gray-600",children:t.jsx("p",{className:"text-sm",children:"\uD83E\uDDE9 Vista previa en construcci\xf3n. Pr\xf3ximamente mostrar\xe1 el resumen del pedido empresarial antes de publicar."})})}},8410:(e,a,r)=>{"use strict";r.r(a),r.d(a,{$$typeof:()=>i,__esModule:()=>l,default:()=>n});var t=r(8570);let s=(0,t.createProxy)(String.raw`D:\CARPETA ROGER\CONESTESOYBILLONARIOYALOSOY\jobs-mvp-next-pro-main\app\client\new\page.jsx`),{__esModule:l,$$typeof:i}=s;s.default;let n=(0,t.createProxy)(String.raw`D:\CARPETA ROGER\CONESTESOYBILLONARIOYALOSOY\jobs-mvp-next-pro-main\app\client\new\page.jsx#default`)}};var a=require("../../../webpack-runtime.js");a.C(e);var r=e=>a(a.s=e),t=a.X(0,[948,606,163,259],()=>r(2e3));module.exports=t})();